---
// Helper untuk mengecek active state menu
const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1); // remove the first "/"
---

<!-- DESKTOP NAVBAR (Hidden on Mobile) -->
<nav class="hidden md:flex fixed top-0 w-full z-50 glass-panel transition-colors">
    <div class="max-w-6xl mx-auto px-6 h-16 w-full flex items-center justify-between">
        <!-- Logo -->
        <a href="/" class="text-xl font-bold tracking-tight flex items-center gap-2">
            <div class="w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-brand-500/20">
                <span class="font-mono font-bold text-sm">ID</span>
            </div>
            <span>IDGO<span class="text-zinc-400">.dev</span></span>
        </a>
        
        <!-- Menu -->
        <div class="flex gap-8 text-sm font-medium text-zinc-500 dark:text-zinc-400">
            <a href="/" class={`hover:text-brand-600 dark:hover:text-white transition-colors ${pathname === '/' ? 'text-brand-600 dark:text-white font-bold' : ''}`}>Home</a>
            <a href="/work" class={`hover:text-brand-600 dark:hover:text-white transition-colors ${currentPath.startsWith('work') ? 'text-brand-600 dark:text-white font-bold' : ''}`}>Work</a>
            <a href="/blog" class={`hover:text-brand-600 dark:hover:text-white transition-colors ${currentPath.startsWith('blog') ? 'text-brand-600 dark:text-white font-bold' : ''}`}>Blog</a>
            <a href="/about" class={`hover:text-brand-600 dark:hover:text-white transition-colors ${currentPath.startsWith('about') ? 'text-brand-600 dark:text-white font-bold' : ''}`}>About</a>
        </div>

        <!-- Right Actions -->
        <div class="flex items-center gap-4">
            <!-- Theme Toggle Button (Inline) -->
            <button id="theme-toggle" class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-zinc-600 dark:text-zinc-400">
                <i class="ph ph-sun text-lg hidden dark:block"></i>
                <i class="ph ph-moon text-lg block dark:hidden"></i>
            </button>
            <a href="mailto:hello@idgo.dev" class="bg-zinc-900 dark:bg-white text-white dark:text-zinc-950 px-5 py-2 rounded-lg text-sm font-semibold hover:opacity-90 transition-opacity">
                Contact
            </a>
        </div>
    </div>
</nav>

<!-- MOBILE TOP BAR (Logo + Theme) -->
<div class="md:hidden fixed top-0 w-full z-50 glass-panel px-6 h-14 flex items-center justify-between transition-colors">
    <a href="/" class="font-bold text-lg flex items-center gap-2">
            <div class="w-6 h-6 bg-brand-600 rounded flex items-center justify-center text-white">
            <span class="font-mono font-bold text-[10px]">ID</span>
        </div>
        IDGO.dev
    </a>
    <button id="theme-toggle-mobile" class="p-2 text-zinc-600 dark:text-zinc-400">
        <i class="ph ph-sun text-lg hidden dark:block"></i>
        <i class="ph ph-moon text-lg block dark:hidden"></i>
    </button>
</div>

<!-- MOBILE BOTTOM NAV (App Style with Icons) -->
<div class="md:hidden fixed bottom-0 w-full bg-white/90 dark:bg-zinc-950/90 backdrop-blur-lg border-t border-zinc-200 dark:border-zinc-800 flex justify-around items-center h-20 z-50 pb-2 transition-colors">
    <a href="/" class={`flex flex-col items-center gap-1 p-2 transition-colors ${pathname === '/' ? 'text-brand-600 dark:text-white' : 'text-zinc-500 dark:text-zinc-400'}`}>
        <i class={`text-2xl ${pathname === '/' ? 'ph-fill ph-house' : 'ph ph-house'}`}></i>
        <span class="text-[10px] font-bold">Home</span>
    </a>
    <a href="/work" class={`flex flex-col items-center gap-1 p-2 transition-colors ${currentPath.startsWith('work') ? 'text-brand-600 dark:text-white' : 'text-zinc-500 dark:text-zinc-400'}`}>
        <i class={`text-2xl ${currentPath.startsWith('work') ? 'ph-fill ph-briefcase' : 'ph ph-briefcase'}`}></i>
        <span class="text-[10px] font-medium">Work</span>
    </a>
    <a href="/blog" class={`flex flex-col items-center gap-1 p-2 transition-colors ${currentPath.startsWith('blog') ? 'text-brand-600 dark:text-white' : 'text-zinc-500 dark:text-zinc-400'}`}>
        <i class={`text-2xl ${currentPath.startsWith('blog') ? 'ph-fill ph-article' : 'ph ph-article'}`}></i>
        <span class="text-[10px] font-medium">Blog</span>
    </a>
    <a href="/about" class={`flex flex-col items-center gap-1 p-2 transition-colors ${currentPath.startsWith('about') ? 'text-brand-600 dark:text-white' : 'text-zinc-500 dark:text-zinc-400'}`}>
        <i class={`text-2xl ${currentPath.startsWith('about') ? 'ph-fill ph-user' : 'ph ph-user'}`}></i>
        <span class="text-[10px] font-medium">About</span>
    </a>
</div>

<script>
    // Logic Dark Mode Toggle
    function setupTheme() {
        const btns = [document.getElementById('theme-toggle'), document.getElementById('theme-toggle-mobile')];
        const html = document.documentElement;

        btns.forEach(btn => {
            if(btn) {
                btn.addEventListener('click', () => {
                    if (html.classList.contains('dark')) {
                        html.classList.remove('dark');
                        localStorage.setItem('theme', 'light');
                    } else {
                        html.classList.add('dark');
                        localStorage.setItem('theme', 'dark');
                    }
                });
            }
        });
    }

    // Jalankan saat load awal
    setupTheme();
    // Support Astro View Transitions (biar ga rusak pas pindah page)
    document.addEventListener('astro:after-swap', setupTheme);
</script>