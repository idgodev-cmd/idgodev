---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
    const projects = await getCollection('projects');
    return projects.map((project) => ({
        params: { slug: project.slug },
        props: { project },
    }));
}

const { project } = Astro.props;
const { Content } = await project.render();
---

<BaseLayout title={project.data.title} description={project.data.description} image={project.data.heroImage}>
    
    <div class="max-w-5xl mx-auto">
        <!-- Navigasi Balik -->
        <a href="/work" class="inline-flex items-center gap-2 text-sm font-bold text-zinc-500 hover:text-brand-600 transition-colors mb-8">
            <i class="ph ph-arrow-left"></i> Kembali ke Portofolio
        </a>

        <div class="grid md:grid-cols-2 gap-12 mb-16 items-start">
            <!-- Kolom Teks (Kiri) -->
            <div class="order-2 md:order-1">
                <h1 class="text-5xl md:text-6xl font-display font-bold mb-6 text-zinc-900 dark:text-white leading-tight">
                    {project.data.title}
                </h1>
                
                <!-- Tech Stack Tags -->
                <div class="flex flex-wrap gap-2 mb-8">
                    {project.data.techStack && project.data.techStack.map((tech: string) => (
                        <span class="px-3 py-1 bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-full text-xs font-bold text-zinc-600 dark:text-zinc-300">
                            {tech}
                        </span>
                    ))}
                </div>

                <div class="prose prose-lg dark:prose-invert prose-zinc mb-8">
                    <p class="lead text-xl text-zinc-600 dark:text-zinc-400 font-medium">
                        {project.data.description}
                    </p>
                    <Content />
                </div>

                <!-- Tombol Visit -->
                <div class="flex gap-4">
                    {project.data.link && (
                        <a href={project.data.link} target="_blank" class="inline-flex items-center gap-2 px-8 py-3 bg-zinc-900 dark:bg-white text-white dark:text-zinc-950 rounded-full font-bold hover:scale-105 transition-transform shadow-xl shadow-brand-500/10">
                            Kunjungi Website <i class="ph ph-arrow-up-right"></i>
                        </a>
                    )}
                </div>
            </div>

            <!-- Kolom Gambar (Kanan - Sticky) -->
            <div class="order-1 md:order-2 md:sticky md:top-32">
                <div class="rounded-3xl overflow-hidden border border-zinc-200 dark:border-zinc-800 shadow-2xl bg-zinc-100 dark:bg-zinc-900">
                    <img 
                        src={project.data.heroImage || 'https://placehold.co/800x600'} 
                        alt={project.data.title} 
                        class="w-full h-auto"
                    />
                </div>
            </div>
        </div>
    </div>

</BaseLayout>